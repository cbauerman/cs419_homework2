<script src="sylvester.js" type="text/javascript"></script>
<script src="glUtils.js" type="text/javascript"></script>
<script src="test.js" type="text/javascript"></script>

<body onload="start();">
<canvas id="glcanvas" width="768" height="768">
Your browser doesn't appear to support the HTML5 <code>&lt;canvas&gt;</code> element.
</canvas>
</body>

<script id="shader-fs-sphere" type="x-shader/x-fragment">
	uniform lowp vec4 AmbientProduct, DiffuseProduct, SpecularProduct;
	uniform lowp vec3 Eye;
	uniform float Shininess;
	
	varying vec3 N;
	varying vec4 E;
	varying vec3 L;
	
	void main(void) {
	
		vec3 fN = normalize(N);
		vec3 fE = normalize(Eye - E);
		vec3 fL = normalize(L);
		
		vec3 H = normalize( fL + fE.xyz );
	
		vec4 ambient  = AmbientProduct;
		vec4 diffuse  = max(dot(fL, fN), 0.0) * DiffuseProduct;
		vec4 specular = pow(max(dot(fN, H), 0.0), Shininess) * SpecularProduct;
	
		if( dot(fL, fN) < 0.0 )
		{
			specular = vec4(0.0, 0.0, 0.0, 1.0);
		}

		gl_FragColor = vec4( (ambient + diffuse + specular).xyz, 1.0);
	}
</script>

<script id="shader-vs-sphere" type="x-shader/x-vertex">
	attribute vec3 vPosition;
	attribute vec3 vNormal;

	varying vec3 N;
	varying vec3 L;
	varying vec4 E;

	uniform mat4 ModelView;
	uniform mat4 Projection;
	uniform vec4 LightPosition;

	void main(void) {
		N = vec4(vNormal, 0.0)).xyz; 
		E = vec4(vPosition, 1.0);
		L = LightPosition.xyz;

		if(LightPosition.w != 0.0)
		{
			L = L - vPosition;
		}

		gl_Position = Projection * ModelView vec4(vPosition, 1.0);
	}
</script>